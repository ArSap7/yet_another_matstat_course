%!TEX TS-program = xelatex
\documentclass[12pt, a4paper]{article}

% Можно вставить разную преамбулу
\input{preamble}

\title{
\begin{center} 
\includegraphics[width=0.99\textwidth]{images/logo.png}
\end{center}

Посиделка 2: комбинаторика и вероятности}
\date{ } %\today}

% Если делаешь конспект, вписывай своё имя прямо сюда!
\author{Ульянкин Ппилиф \thanks{\url{https://github.com/FUlyankin/yet_another_matstat_course}}}

\begin{document} % Конец преамбулы, начало файла

\maketitle

\epigraph{Лёд тронулся, господа присяжные и заседатели!}{\textit{Великий Комбинатор Остап-Сулейман-Берта-Мария-Бендер-бей}}








\section{Предмет комбинаторики}

\indef{Комбинаторика} - это раздел дискретной математики, в котором решаются задачи, связанные с выбором элементов, как правило, из конечного множества и расположения их в соответствии с заданными правилами. \par 
Каждое такое правило позволяет построить конструкцию из элементов данного множества. Такая конструкция называется \indef{комбинаторной конфигурацией.} \par 
Задачами комбинаторного анализа являются разработка алгоритмов построения комбинаторных конфигураций и конфигурация этих алгоритмов. \par 
Число современных задач, решаемых комбинаторными методами относятся: 

\begin{enumerate}
    
    \item Задачи на размещение на плоскости некоторых плоских фигур с указанными свойствами;
    
    \item Задачи на заполнение некоторых пространственных тел меньшими телами с указанными объёмами и конфигурацией;
    
    \item Задачи на кратчайшие пути;
    
    \item Задачи компьютерных, транспортных и электрических сетей и многое другое.

\end{enumerate}

Отметим, что основными операциями над множествами в комбинаторном анализе являются две операции: отбор элементов из множества и упорядочение их по заданным правилам.\par 
К числу простейших комбинаторных конфигураций относится размещение, перестановки, сочетания множеств и др. При подсчёте их числа используются два правила: правило суммы и правило произведения.

\section{Правило суммы и правило произведения.}


\indef{Правило 1}(правило суммы).\par
Пусть дано некоторое множество \textbf{S}, и из этого множества подмножество \textbf{A}(оно может состоять из одного элемента) можно выбрать m способами, а подмножество \textbf{B} можно выбрать n способами, причём эти выборы таковы, что их нельзя осуществить одновременно, то тогда выбрать $\textbf{A} \cup \textbf{B}$ из множества \textbf{S} можно m+n способами.\par 

\underline{Пример.} Есть 100 деталей - 60 штук 1-го сорта, 30 штук 2-го сорта, 10 - 3-го сорта. Тогда выбрать детали 1-го и 2-го сорта есть 60 + 30 = 90 способов.

\indef{Правило 2}(правило произведения). \par 
Пусть из множества \textbf{S} подмножество \textbf{A} можно выбрать m способами. После этого, подмножество \textbf{B} можно выбрать n способами. Тогда $\textbf{A} \cup \textbf{B}$ можно выбрать $m \cdot n$ способами. Отметим, что правило произведения на практике часто используется в следующей формулировке: \par 

Пусть 1-е действие можно выполнить n способами, после этого 2-е действие - $n_2$ способами и тогда k-е действие можно выполнить $n_k$ способами. То тогда выполнить все n указанных действий можно $n_1 \cdot n_2 \cdot n_3 \cdot \dots \cdot n_k$ способами. \par 

\underline{Пример.} Сколько существует пятизначных чисел? 
Так как на 1 месте в пятизначном числе не может стоять 0(т.к. тогда бы это было четырёхзначное число), то выбрать первую цифру на 1 место можно 9-ю способами(это может быть 1,2,3,4,5,6,7,8,9). Выбрать 2, 3, 4, 5 место можно выбрать 10-ю способами(это может быть 1,2,3,4,5,6,7,8,9 или 10). Значит, всего существует $9 \cdot 10^4 = 90000$ способов.


\section{Размещение.}


\subsection{Размещение без повторения.}

Есть множество s  из n различных элементов, будем выбирать из него по одному последовательно k элементов 0 < k < n каждый элемент перед отбором следующего не возвращается в s Такой отбор называется размещение из n элементов по k. 

То есть это такие комбинации из этих n элементов, каждая из которых содержит в точности k элементов и отличаются эти комбинации одна от другой либо составом либо порядком элементов при этом предполагается, что все n элементов множества s - различные. 

(*)$A_n^k = n (n-1) \dots (n-(k - 1))$ - общее число размещений из n элементов по k 

1-ый - можно выбрать n способами, 2-ой - (n-1) способами, \dots k-ый (n-(k-1))- способами, тогда по правилу произведения получим на лицо формулу(*)

\underline{Пример}:

16 команд в турнире. Сколько вариантов распределить призовые места:

$A_n^K = A_{26}^3 = 16*15*14$

\subsection{Размещение с повторениями.}

Снова есть множество из n элементов. Отбираем из него k<n элементов. 

Но теперь каждый отобранный элемент перед отбором следующего возвращается в множество S. 

Это будет размещением из n элементов по к с повторениями.



Общее число размещений с повторениями обозначаем, как $\hat{A}_n^k$
%нормальное обозначение

Получаем формулу: 1-ый - n способами, 2-ой - n  способами \dots k-ый -n способами, тогда, по правилу произведения  $\hat{A}_n^k = n^k$

\underline{Пример}:

Сколько трехзначных чисел можно составить из чисел 1,2,3,4


%1-ая - 4 способами, 2-ая - 4 способами, 3-ая - 4-способами

N= $\hat{A}_n^k = n^k$ = $4^3$ = 64

\section{Перестановки.}



\subsection{Перестановки без повторений.}

Пусть есть множество S, состоящее из n элементов k=n, тогда из множества S отбираются все его элементы. И значит одна комбинация от другой  может отличаться только порядком элементов.

То есть перестановки из n различных элементов это такие комбинации из этих элементов, каждая из которых содержит все n элементов.

$P_n=n!$

%комментарий

$P_n = A_n^k = n(n-1)(n-2)\dots(n-(n-1)) = n!$

\subsection{Перестановки с повторениями.}

Во множество S n элементов, среди них есть одинаковые элементов первого типа $n_1$, второго $n_2$, \dots k-ого $n_k$. Так что $n_1+n_2+\dots +n_k=n$

Перестановки с повторения будем обозначать так: $P_n(n_1,n_2,\dots ,n_k)$

Возьмём любую из перестановок этих n элементов. В ней элементы первого типа можно переставит $n_1!$ раз при этом перестановка не изменится. Элементов второго $n_2!$ и так далее к-ого $n_k!$ и ничего не изменится. Если б все элементы были разными, то $P_n=n!$

Теперь их будет меньше в $n_1!n_2!\dots n_k! \xRightarrow[]{} P_n(n_1,n_2,\dots, n_k) =  \frac{n!}{n_1!n_2!\dots n_k!} $

\section{Сочетания.}

\subsection{Сочетания без повторений.}

Сочетанием из n по k элементов называются такие комбинации из этих n элементов, каждая из которых содержит k Элементов и отличается одна комбинация от другой только составом элементов

Возьмем сочетание из n по k, переставим в ней элементы всевозможными образом, получим k! комбинаций. 

Получим размещение $A_n^k$ $C_n^k \cdot k! = A_n^k \xRightarrow[]{} С_n^k = \frac{A_n^k}{k!} = \frac{n!}{k!(n-k)!}$

\underline{Пример}:

Из группы в 10 человек надо выделить 3 для работы
$C_{10}^3 =  \frac{10!}{3!7!} = \frac{8\cdot 9 \cdot 10}{6} = \frac{8 \cdot 3 \cdot 5}{1} = 120$

\subsection{Сочетания с повторениями.}

Если в сочетании элементы могут повторяться, то такие сочетания называются сочетаниями с повторениями из n элементов по k.

Можно показать, что общее число сочетаний с повторениями из n по k находятся по формуле $\hat{C}_n^k = С_{n+k-1}^k$

\underline{Пример}:

Есть 4 вида пирожных. Сколько разных вариантов при покупке 7 пирожных. 

$\hat{C}_4^7 = С_{4+7-1}^7 = С_{10}^7=120$




\underline{Замечание}: 

\begin{enumerate}
    \item Множество как правило конечное 
    \item Основными операциями над элементами множества являются отбор и упорядочение их
    
\end{enumerate}

\section{Разбиение множества на группы.}

Пусть есть множество S, состоящее из N различных элементов. Подсчитаем сколько есть вариантов разбиения этого множества S на K упорядоченных подмножеств $S_1,S_2, \dots ,S_k$  можно рассмотреть как последовательность их расположения. Первое подмножество $S_1$, содержащее $n_1$ элементов выбираем из множества S, состоящего из n элементов $С_ {n}^{n_1}$ 

После этого выбираем подмножество $S_2$ из $S(n-{n_1})$ элементов $C_{n-{n_1}}^{n_2} $, теперь выбираем подмножество $S_3$ Из $S(n-{n_1}-{n_2})$ элементов. 

$C_{n-{n_1}-{n_2}}^{n_3} $

\dots

Подмножество $S_k$ состоящее из $n_k$ элементов из $S(n-{n_1}-{n_2}\dots -{n_{k-1}}$  

$C_{n-{n_1}-{n_2}- ...-{n_{k-1}}}^{n_k} $

Тогда по правилу произведения получаем, что выбрать подмножества 

$S_1, \dots , S_k$ из S в указанном порядке можно следующим числом способов:


$C_{n}^{n_1} $
\cdot$C_{n-{n_1}}^{n_2} $
\cdot$C_{n-{n_1}-{n_2}}^{n_3} $
\dots \cdot$C_{n-{n_1}-{n_2}- ...-{n_{k-1}}}^{n_k} $= $\frac{n!}{n_1,n_2,\dots n_k}$

Столько вариантов разбиения множества S состоящего из n различных элементов на k упорядоченных подмножеств непустых и не пересекающихся с числом элементов $n_1,n_2 \dots n_k$

$N(n_1,n_2,\dots n_k)$ - число разбиений

$N(n_1,n_2,\dots n_k) = \frac{n!}{n_1,n_2,\dots n_k}$

\underline{Пример}:

В группе шли выборы старосты, за предложенную кандидатуру проголосовало 15, и 5 против, 5 воздержались. Сколько вариантами могли быть проведены выборы?

$N(15,5,5) = \frac{25!}{15!\dot5!\dot5!}$

\section{Определение числа элементов в объединении нескольких элементов.}

\subsection{Метод включения и исключения.}

Этот метод применяется в задаче, когда рассматриваемое множество надо разбить на подмножества в зависимости от того, обладают ли его элементы определенными свойствами. 

Определение числа элементов в объединении нескольких множеств:

Даны множества A и B
n(A), n(B) 
$n(A \cup B) -?$ 

$n(A\cup B) = n(A) + n(B), если A \cap B =   \emptyset$

$A\cap B \neq \emptyset, то n(A\cup B) = n(A) + n(B) - n(A\cap B)$

%картинка 

Посчитаем число элементов в объединении 3-ех множеств: 

$n(A\cup B\cup C) = n(A) + n(B) + n(C) - n(A \cap B) - n(A \cap C) - n(B  \cap C) + n(A \cap B \cap C)  $

$n(A\cup B\cup C) = n[A\cup \textbf{(B\cup C)}] = n(A) + n(B\cup C) - n(A\cap(B \cup C)) = n(A) + n(B) + n(C) - n(B\cap C) - n(A\cap B) - n(A \cap C) + n((A\cap B)+ (A\cap C)) = n(A) + n(B) + n(C) - n(A\cap B) - n(A\cup C) - n(A\cap B \cap C)$

Если объединяется k множеств, то число элементов в их объединении находится по формуле:

$n( \cup_{i=1}^k A_i) = \sum_{i=1}^k n (A_i) - n(A_1 \cap A_2\cap \dots \cap A_k) $

(*)

\underline{Следствие}:

Пусть есть множество $A,A_1,\dots A_k $ - подмножество множества A. Тогда число элементов множества A, не принадлежащих на одному из множеств $A,A_1,\dots A_k $ находится по формуле:

$N= n(A) - (n(A_1)+\dots +n(A_k)) + (n(A_1 \cap A_2) + n(A_1 \cap A_3)+ \dots n(A_{k-1} \cap A_k) + \dots  (-1)^{k-1} n(A_1\cap A_2\dots  \cap A_k) + \dots +(-1)^{k-1} n(A_1 \cap A_2 \dots \cap A_k)   $ 
%формула (1)

Формула (1) непосредственно следует из равенства (*)

\underline{Пример}

Все, кто работает в лаборатории знают хотя бы один иностранный язык.

Английский - 12 человек, Немецкий - 8 человек,Французский - 7 человек,Английский и немецкий - 5 человек, Английский и Французский - 4 человека, немецкий и французский - 3 человека, все 3 языка - 2 человека

Сколько всего человек работает в лаборатории.

$n(A\text{А}\cup A\text{Н} \cup A\text{Ф} ) = n(A\text{А}) + n(A\text{Ф}) + n(A\text{Н}) - n(A\text{А}\cap A\text{Н}) + n(A\text{А}\cap A\text{Ф})+
n(A\text{Ф}\cap A\text{Н}) + n(A\text{А}\cap A\text{Н}\cap A\text{Ф}) = 12 + 8 + 7 -(5 + 4 +3) + 2 = 29 - 12 = 17$

\subsection{Определение числа элементов множества не обладающего ни 1 из свойств.}

Пусть есть некоторое множество, состоящее из N элементов и n свойств  $P_1,P_2,\dots P_n$ совместимых друг с другом.

Число элементов этого множества, обладающих свойствами $P_i1,P_i2,\dots P_ik$(обозначим $N i1,i2,\dots ik$) и может быть некоторыми другими

Число N(0) элементов данного множества, не обладающих ни одним из свойств $P_1,P_2, \dots P_n$ находится по следующей формуле:

$N(0)= N - S_1 + S_2 - S_3 + \dots +(-1)^n S_n$(*), где 
$S_1$
- число элементов обладающих одним свойством:

$S_1 = N_1 + N_2 + \dots N_n$

$S_2 = N_12 + N_13 + \dots N_{{n-1}_n}$- Обладающих 2 свойствами

$S_3$- Обладающих 3 свойствами

И так дальше

Эта формула непосредственно следует из формулы предыдущего пункта

\underline{Пример}

S - Множество целых чисел от 1 до 100 

$P_1$ делится на 2, $P_2$ делится на 3, $P_3$ делится на 5, тогда число чисел от 1 до 100, не делящихся ни на 2, ни на 3, ни на 5

Найдем по формуле N(0) = N -$S_1 + S_2 - S_3$

$S_1 = N_1 + N_2 + N_3$

$N_1 $- число чисел от 1 до 100 обладающих свойством $P_1$



$N_1 = [\frac{100}{2}]=50$
$N_2 = [\frac{100}{3}]=33$
$N_3 = [\frac{100}{5}]=20$

$S_2 = N_12 + N_13 + N_23$

$N_12 =[\frac{100}{6}]=16$ 
$N_13 =[\frac{100}{10}]=10$
$N_23 =[\frac{100}{6}]=16$

$S_3 = N_123$

$N_123 = [\frac{100}{30}] = 3$

N(0) = 100 - 103 - 32 -3 = 26
\subsection{Определение числа элементов множества, обладающего определенным набором свойств.}

N,n - свойства $P_1,P_2,\dots P_n$, совместимых друг с другом. Обобщая формулу(*) можно получить формулу для числа элементов этого множества, обладающего ровно r свойствами из n (1 $\leq$ r $\leq$ n)

$N(r)= C_r^r \cdot S(r) - C_{r+1}^r \cdot S(r+1) + C_{r+2}^r \cdot S(r+2)- \dots (-1)^{n-r} C_n^r \cdot S(n)$ (1)

S(r) - число элементов данного множества, обладающего r - свойствами

\dots

S(r+1) - r+1 свойством и так дальше

\underline{Пример}

Сколько целых от 1 до 500 $\vdots$ 3,5 или 7

$P_1 \vdots 3, P_2 \vdots 5, P_3 \vdots 7$

$N(1) = C_1^1 S(1) - C_2^1 S(2) + C_3^1 S(3)$ 

$N_1 = [\frac{500}{3}] = 166$
$N_2 = [\frac{500}{5}] = 100$
$N_3 = [\frac{500}{7}] = 71$

$S(1) = N_1 + N_2 + N_3 = 166 + 106 + 71 = 337$

$N_{12}= [\frac{500}{15}]=33$
$N_{13}= [\frac{500}{21}]=23$
$N_{23}= [\frac{500}{35}]=7$

$S(2) = N_{12} + N_{13} + N_{23}= 33 + 23 + 7 = 70$ 


$S(3) = N_{123} = [\frac{500}{105}] = 4$

Учитывая это находим: $N(1) = C_1^1 S(1) - C_2^1 S(2) + C_3^1 S(3) = 337 - 140 + 12 = 209$

\section{Бином Ньютона и полиномиальная формула.}

\subsection{Бином Ньютона.}


$(a+b)^n = \sum\limits_{k=0}^n  C_{n}^{k} \cdot a^k b^{n-k}$

\(\blacksquare\)\textbf{Доказательство (методом математической индукции):}\\

1. Докажем при n = 1 (база индукции):

$(a+b)^1 = \sum\limits_{k=0}^1  C_{1}^{k} \cdot a^k b^{1-k} = C_{1}^{0}a^0b^1 + C_{1}^{1}a^1b^0 = b + a$

2. Переход: предположим, что верно при n-1, то есть $(a + b)^{n-1} = \sum\limits_{k=0}^n  C_{n-1}^{k} \cdot a^k b^{n-1-k}$

3. Докажем, что верно при n:

$(a+b)^{n} = (a+b)^{n-1}(a+b) = \sum\limits_{k=0}^{n-1} C_{n-1}^{k} a^k b^{n-1-k} \cdot (a+b) = \sum\limits_{k=0}^{n-1} C_{n-1}^{k} a^{k+1} b^{n-1-k}(\sum_1) \cdot \sum\limits_{k=0}^{n-1} C_{n-1}^{k} a^k b^{n-k}(\sum_2) $

$\textrm{В} \sum_1 \text{ заменяем индекс суммирования } {k={j-1}},$ 

$\sum_1=\sum\limits_{j=1}^{n}  C_{n-1}^{j-1} \cdot a^{j} b^{n-j} \text{ после преобразуем индекс суммирования }  \sum_1 = \sum\limits_{k=1}^{n}  C_{n-1}^{k-1} \cdot a^k b^{n-k}$

\textrm{Учитывая это:}

$(a+b)^n = \sum\limits_{k=1}^{n}  C_{n-1}^{k-1} \cdot a^{k} b^{n-k} + \sum\limits_{k=0}^{n-1}  C_{n-1}^{k} \cdot a^{k} b^{n-k}$

Выравниваем индексы суммирования, сделаем их от 0 до n одинаковыми. Для этого добавим нулевые сочетания:
$C_{n-1}^1=0$ в начало $\sum_1$, $C_{n-1}^n = 0$ в конец $\sum_2$, получим:

$\sum\limits_{k=0}^{n} C_{n-1}^{k-1} a^k b^{n-k} +  \sum\limits_{k=0}^{n} C_{n-1}^{k} a^k b^{n-k}  = \sum\limits_{k=0}^n  a^k b^{n-k} \cdot (C_{n-1}^{k-1} + C_{n-1}^{k}) \text{, то есть}$ 

$(a+b)^n =  \sum\limits_{k=0}^n  a^k b^{n-k} \cdot (C_{n-1}^{k-1} + C_{n-1}^{k} ) (*)$



\textrm{Вычислим:}
$C_{n-1}^{k-1} + C_{n-1}^{k}= \frac{(n-1)!}{(k-1)!(n-k)!} + \frac{(n-1)!}{(n-1-k)!(k)!}= \frac{(n-1)!}{(k-1)!(n-k-1)!}(\frac{1}{k}+ \frac{1}{n-k}) = \frac{(n-1)!}{(k-1)!(n-k-1)!} \cdot \frac{n}{(n-k)k} = \frac{n!}{k!(n-k)!} = C^{k}_n \textrm{ (подставим это в равенство *)}
$

{$\Longrightarrow$}
\[(a+b)^n =\sum\limits_{k=0}^n  C_{n}^{k} \cdot a^k b^{n-k}
\]




Бином Ньютона - основа для многих комбинаторных формул.

\begin{enumerate}

    \item $a = 1, b = 1,$
    
    $2^n=\sum\limits_{k=0}^n C_{n}^{k} = C_{n}^{0} +C_{n}^{1} + C_{n}^{2} + ... + C_{n}^{n}$,
    
    то есть сумма биномиальных коэффициентов $C_{n}^{k} = 2^n$
    
    * С точки зрения теории множеств эта формула означает, что число всех подмножеств множества, состоящего из n элементов = $2^n$ или мощность множества всех подмножеств, состоящего из всех элементов = $2^n$
    
    
    \item  $a = 1, b = -1:$ $\sum\limits_{k=0}^n C_{n}^{k} (-1)^{n-k} = 0$
    
    $a = -1, b = 1:$
    $\sum\limits_{k=0}^n C_{n}^{k} (-1)^{k} = 0$
    
    А это означает, что сумма биномиальных коэффициентов, стоящих на четных и нечетных позициях одинакова и каждая из них равна $2^{n-1}$
    
    * Это замечание следует из предыдущей  формулы
    
\end{enumerate}

Отметим еще некоторые свойства биномиальных коэффициентов:

\begin{enumerate}

\item $C_{n-1}^{k-1} + C_{n-1}^{k} = C_{n}^{k} $

\(\blacksquare\) Доказательство было приведено при доказательстве бинома Ньютона% Гиперссылочку?

\item $C_{n}^{n-k} = C_{n}^{k}$ - Биномиальные коэффициенты одинаково удаленные от начала(конца) разложения равны между собой

\(\blacksquare\) Проведите доказательство самостоятельно, разложив сочетания по формуле.

\end{enumerate}

\subsection{Полиномиальная формула.}

Обобщение бинома Ньютона для нескольких слагаемых(>2) является полиномиальной формулой:
\[
(a_1 + a_2 + ... + a_k)^n = \sum\limits_{\substack{r_1\geq 0,r_2\geq 0...r_k\geq 0 \\ r_1+r_2+...+r_k=1 }} \frac{n!}{r_1!r_2!...r_k!} a_1^{r_1} a_2^{r_2} \dotsc a_k^{r_k}
\]



Здесь суммирование ведется по целым неотрицательным решениям уравнения $r_1+r_2+...+r_k=1$ 

$\geq$









\begin{thebibliography}{1}
	\bibitem{Shan:sets}
	\emph{Николай Константинович Верещагин и Александр Шень.} (1999).
	Начала теории множеств.~//
	\url{http://www.mccme.ru/free-books/}
	%\cite{Franclin:sets}.
  сюда занимательную комбинаторику и мб чет еще от райгородского
\end{thebibliography}

\end{document}
